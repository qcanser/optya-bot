import time
import os
import telebot
import pandas
import feedparser
import random
import schedule
import requests
import json
from easygoogletranslate import EasyGoogleTranslate
from flask import Flask, request
from datetime import datetime
from time import mktime
from multiprocessing import *
from telebot import types


TOKEN = "5218759908:AAFRlXyzPtk-25nmMjOCexKpSO4W9L_DkRQ"
bot = telebot.TeleBot(TOKEN)
group_id = "-1001579039420"
translator = EasyGoogleTranslate(
    source_language='en',
    target_language='ru',
    timeout=10
)

def start_process():
    p1 = Process(target=TimeSchedule.start_schedule, args=()).start()

class TimeSchedule():
    def start_schedule():
        schedule.every().day.at("00:00").do(TimeSchedule.send_congratulations)
        schedule.every().day.at("21:08").do(TimeSchedule.nicejoke)
        # schedule.every().friday.at("13:15").do(TimeSchedule.send_new_podcast)

        while True:
            schedule.run_pending()
            time.sleep(1)


    def send_congratulations():
        data = pandas.read_csv("birthdays.csv")
        today = datetime.now()
        today_tuple = (today.month, today.day)
        birthdays_dict = {(data_row["month"], data_row["day"]): data_row for (index, data_row) in data.iterrows()}

        if today_tuple in birthdays_dict:
            birthday_person = birthdays_dict[today_tuple]
            name = birthday_person["name"]
            bot.send_message(group_id, f"С Днём Рождения {name}! 🥳🥳🥳👋👋👋🔈🔈🔈🍺🍺🍺🍻🍻🍻😃😃😃")
        else:
            bot.send_message(group_id, 'Сегодня нет именинников.')
    def nicejoke():
        req = requests.get("https://api.humorapi.com/jokes/random?api-key=ddb5a27446fc44f4b87496e160b46711").text
        jsonText = json.loads(req)
        lolkek = jsonText["joke"]
        result = translator.translate(lolkek)
        bot.send_message(group_id, result)

@bot.message_handler(regexp='Оптя как ты?')
def event(message):
    random_answer_event = ['По каналу Кино ТВ Криминальное чтиво идёт 😎👌',
                        'Ребята у меня с 18 декабря отпуск . Я всё таки Вас соберу !',
                        'По тв 3 Шакал начался с Брюсом Уильямсом',
                        'Я всегда за👍🙏🥳',
                        'Ребзя, я в кино...',
                        'Хочу Хардкор!!!🤦‍♂️🤦‍♂️🤦‍♂️🥳🥳🥳🙃🙃🙃',
                        'Я в Старом амбаре в седьмом...))) Паспорт загранник получил!)))',
                        'Да я уж дома...))) Хотел пивас попить после работы...)))',
                        'Сейчас приеду 🤣🤣🤣',
                        'Куда ехать?🤣🤣🤣🤦‍♂️🤦‍♂️🤦‍♂️👻👻👻',
                        'Фашиста слушаю Казантип 2004 год 🔥🔥👌😊👏👏👏💯💯💯',
                        'На фильм Скандал пошёл.)))) Уж больно мне актрисы нравятся 😜😃😃😃',
                        'У кого какие соображения?',
                        'Когда сход ребзя?!',
                        'Начались тупые вопросы 🤦‍♂️🤦‍♂️🤦‍♂️🤣🤣🤣🤩🤩🤩',
                        'Я тут одно мужичка нашёл, наверное мой одногодка, музыку пишет электронную Ильшат Газизов. Как нибудь его пригласим к нам на сход!))))',
                        'Ребята я в отпуск 🥳🥳🥳🍻🍻🍻👏👏👏👏👏👏👏👌😃',
                        'Ребята пока я в отпуске, может как нибудь в тихоря стрелбан? У кого есть какие соображения?',
                        'Я+']
    
    bot.send_message(message.chat.id, random.choice(random_answer_event))

@bot.message_handler(content_types=["pinned_message", "photo", "voice", "video"])
def reply_genius(message):
    random_answer = [
                    'Гениально 👍👍👍🔥🔥🔥🥰🥰🥰😃😃😃',
                    'Спасибо судья 👍🔥😊😊😊', 
                    'Гениально 👍👍👍👍👏👏👏😁😁😁',
                    'Спаси сохрани 🙏🙏🙏🤦‍♂️🤦‍♂️🤦‍♂️🤣🤣🤣',
                    'Я в шоке!!!🤦‍♂️🤦‍♂️🤦‍♂️🙏🙏🙏😃😃😃🔥🔥🔥🥰🥰🥰'
                    'Если честно мне этот телеграмм не нравится. Ватсапу больше предпочтение...(((((',
                    'Вот что бывает когда не пьёшь и за здоровый образ, кукушка ехать начинает.))))))',
                    '👍👍👍👍',
                    'От души 🔥🔥🔥🥰🥰🥰👍👍👍',
                    'Гуд 😁😁😁👍👍👍',
                    'От души, дружище, Спасибо!!!🔥🔥🔥💯💯💯😍😍💪💪💪🙏🙏👍🥩🥩🥩',
                    'Спасибо!!!!👍👍👍🔥🔥🔥💯💯💯🥰🥰🥰',
                    'Спасибо большое Вам!!🔥🔥🔥💯😍😍😍👍👍👍',
                    'Спасибо большое 👍👍👍🔥🔥🔥💯💯🥰🥰🥰',
                    '👍👍👍🔥🔥🔥💯💯💯🥩🥩🥩🥰🥰🥰👍👍👍👍',
                    '🔈🔈🔈🥰🥰🥰🥩🥩🥩🔥🔥🔥💯💯💯👍👍👍😘😘😘'
                    'Это очередной шедевр 🔥🔥🔥🔥👍👍👍👏👏👏',
                    ]
    bot.send_message(message.chat.id, random.choice(random_answer), reply_to_message_id=message.message_id)

@bot.message_handler(commands=['insultMe'])
def greet(message):
    text = requests.get("https://insult.mattbas.org/api/insult").text
    result = translator.translate(text)
    bot.reply_to(message, result)
@bot.message_handler(regexp='insultMe')
def greet(message):
    text = requests.get("https://insult.mattbas.org/api/insult").text
    result = translator.translate(text)
    bot.reply_to(message, result)

bot.polling()
